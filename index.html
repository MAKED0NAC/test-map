<!DOCTYPE html>
<html lang="hr">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>DONAC</title>

<link rel="stylesheet"
 href="https://unpkg.com/leaflet/dist/leaflet.css"/>

<style>
html,body{
  margin:0;
  height:100%;
  background:black;
  overflow:hidden;
}

#map{
  height:100vh;
  width:100vw;
  transform-origin:center center;
  transition:transform 0.3s linear;
}

.center-marker{
  position:fixed;
  top:50%;
  left:50%;
  transform:translate(-50%,-100%);
  font-size:32px;
  z-index:999;
  pointer-events:none;
}
</style>
</head>
<body>

<div id="map"></div>
<div class="center-marker">üìç</div>

<script src="https://unpkg.com/leaflet/dist/leaflet.js"></script>

<script>

let map=L.map('map',{zoomControl:false})
.setView([0,0],16);

L.tileLayer(
'https://{s}.basemaps.cartocdn.com/dark_all/{z}/{x}/{y}{r}.png'
).addTo(map);

let lastHeading=0;

// ROTACIJA MAPE
function rotateMap(deg){
  lastHeading=deg;
  document.getElementById("map")
    .style.transform=`rotate(${-deg}deg)`;
}

// GPS PRAƒÜENJE
navigator.geolocation.watchPosition(pos=>{

let lat=pos.coords.latitude;
let lng=pos.coords.longitude;

map.setView([lat,lng],17,{animate:true});

// heading iz GPS-a (najbolje kad vozi≈°)
if(pos.coords.heading!==null){
  rotateMap(pos.coords.heading);
}

},{
 enableHighAccuracy:true,
 maximumAge:0,
 timeout:5000
});


// FALLBACK KOMPAS (telefon senzori)
if(window.DeviceOrientationEvent){

window.addEventListener("deviceorientationabsolute",e=>{
  if(e.alpha!=null){
    rotateMap(e.alpha);
  }
});

window.addEventListener("deviceorientation",e=>{
  if(e.alpha!=null){
    rotateMap(e.alpha);
  }
});

}

</script>

</body>
</html>
